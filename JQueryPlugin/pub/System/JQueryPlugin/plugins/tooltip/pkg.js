!function(t){var e,o,i,a,s={};function n(e){return t.data(e,"tooltip")}function d(o){if(!(t.tooltip.blocked||o&&"OPTION"==o.target.tagName))if(null!==e){var i=n(e);!i.track&&s.parent.is(":visible")&&t(document.body).unbind("mousemove",d),s.parent.removeClass("viewport-right viewport-bottom");var a=s.parent[0].offsetLeft,l=s.parent[0].offsetTop;o&&(a=o.pageX+i.left,l=o.pageY+i.top,s.parent.css({left:a,right:"auto",top:l}));var r={x:t(window).scrollLeft(),y:t(window).scrollTop(),cx:t(window).width(),cy:t(window).height()},p=s.parent[0];r.x+r.cx<p.offsetLeft+p.offsetWidth&&(a-=p.offsetWidth+20+i.left,s.parent.css({left:a+"px"}).addClass("viewport-right")),r.y+r.cy<p.offsetTop+p.offsetHeight&&(l-=p.offsetHeight+20+i.top,s.parent.css({top:l+"px"}).addClass("viewport-bottom"))}else t(document.body).unbind("mousemove",d)}function l(){var t=n(e);function o(){s.parent.show().css("opacity","1.0")}i=null,t.fade?s.parent.is(":animated")||s.parent.is(":visible")?s.parent.stop().fadeTo(t.fade,e.tOpacity,o):s.parent.stop().fadeIn(t.fade,o):o(),d()}function r(e){var o=n(this);s.parent.stop(),o.delay&&!s.parent.is(":animated")?i=window.setTimeout(l,o.delay):l(),t(document.body).bind("mousemove",d),d(e)}function p(){var i=n(this);if(!t.tooltip.blocked&&this!=e&&(this.tooltipText||i.bodyHandler)){if(e=this,o=this.tooltipText,i.bodyHandler){s.title.hide();var d=i.bodyHandler.call(this);d.nodeType||d.jquery?s.body.empty().append(d):s.body.html(d),s.body.show()}else if(i.showBody){var l=o.split(i.showBody);if(s.title.empty(),s.body.empty(),l.length>1){s.title.html(l.shift()).show();for(var p,h=0;p=l[h];h++)h>0&&s.body.append("<br/>"),s.body.append(p)}else s.body.html(l.shift()).show();s.body.hideWhenEmpty(),s.title.hideWhenEmpty()}else s.title.html(o).show(),s.body.hide();i.showURL&&t(this).url()?s.url.html(t(this).url().replace("http://","")).show():s.url.hide(),a&&a!=i.extraClass&&s.parent.removeClass(a),s.parent.addClass(i.extraClass),a=i.extraClass,r.apply(this,arguments)}}function h(o){var a=n(this);function d(){s.parent.hide().css("opacity","")}t.tooltip.blocked||(i&&window.clearTimeout(i),e=null,a.fade?s.parent.is(":animated")||s.parent.stop().fadeOut(a.fade,d):d())}t.tooltip={blocked:!1,defaults:{delay:200,fade:!1,showURL:!0,extraClass:"",id:"tooltip",top:0,left:0},block:function(){t.tooltip.blocked=!t.tooltip.blocked}},t.fn.extend({tooltip:function(e){return function(e){s.parent||(s.parent=t('<div id="'+e.id+'"><h3></h3><div class="body"></div><div class="url"></div></div>').appendTo(document.body).hide(),t.fn.bgiframe&&s.parent.bgiframe(),s.title=t("h3",s.parent),s.body=t("div.body",s.parent),s.url=t("div.url",s.parent))}(e=t.extend({},t.tooltip.defaults,e)),this.each((function(){t.data(this,"tooltip",e),this.tOpacity=s.parent.css("opacity"),this.tooltipText=this.title,t(this).removeAttr("title"),this.alt=""})).mouseover(p).mouseout(h).click(h).bind("keypress",h)},hideWhenEmpty:function(){return this.each((function(){t(this)[t(this).html()?"show":"hide"]()}))},url:function(){return this.attr("href")||this.attr("src")}})}(jQuery),jQuery((function(t){var e,o={delay:350,track:!0,showURL:!1,showBody:":",extraClass:"foswiki"};function i(o){var i=t(o),a=t.extend({},e,$this.data(),i.metadata());i.tooltip(a)}t(".jqTooltip:not(.jqInitedTooltip)").livequery((function(){var a=t(this);a.addClass("jqInitedTooltip"),e=t.extend({},o,a.data(),a.metadata()),i(this),a.find("[title]").each((function(){i(this)}))}))}));
